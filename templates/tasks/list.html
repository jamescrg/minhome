<div class="card-title flex-center-space">
    <h1>
        {% if tasks_folder_all %}
            All
        {% elif selected_folder %}
            {{ selected_folder.name }}
        {% else %}
            Unsorted
        {% endif %}
    </h1>
    <div style="display:flex;gap:0.5rem">
        <button class="square-button filter-button"
                hx-get="{% url 'tasks-due' %}"
                hx-target="#main-content"
                hx-swap="innerHTML">
            <i class="icon-clock"></i>
        </button>
        <button class="square-button filter-button {% if filter_label == 'custom' %}toggle-active{% endif %}"
                hx-get="{% url 'tasks-filter' %}"
                hx-target="#htmx-modal-container">
            <i class="icon-list-filter"></i>
        </button>
    </div>
</div>
{% include "tasks/taskform.html" %}
<ul class="list-group tasks-list">
    {% for task in tasks %}
        <li class="list-group-item tasks-row">
            <div class="tasks-checkbox">
                <a href="#"
                   hx-post="{% url 'tasks-status' task.id %}"
                   hx-target="#tasks-container"
                   hx-swap="innerHTML">
                    {% if task.status == 1 %}
                        <i class="icon-circle-check-big"></i>
                    {% else %}
                        <i class="icon-circle"></i>
                    {% endif %}
                </a>
            </div>
            <div class="tasks-content">
                <div class="tasks-title">
                    <a class="{% if task.status == 1 %}text-completed{% endif %}"
                       href="#"
                       hx-get="{% url 'tasks-form' task.id %}"
                       hx-target="#htmx-modal-container">{{ task.title }}</a>
                </div>
                {% if task.due_date %}
                    <div class="tasks-due">
                        {{ task.due_date|date:"M j" }}
                        {% if task.due_time %}{{ task.due_time|time:"g:i A" }}{% endif %}
                    </div>
                {% endif %}
            </div>
            {% if task.completed_date %}
                <div class="tasks-completed">Done: {{ task.completed_date|date:"M j" }}</div>
            {% elif task.parent_task %}
                <div class="tasks-recurring">
                    <i class="icon-refresh-cw"></i>
                </div>
            {% endif %}
        </li>
    {% endfor %}
</ul>
{% include "pagination.html" %}
{% if has_completed_tasks %}
    <div class="archive">
        <button class="btn btn-secondary"
                hx-post="{% url 'tasks-clear-htmx' %}"
                hx-target="#tasks-container"
                hx-swap="innerHTML">
            <i class="icon-archive"></i> Archive
        </button>
        <button class="btn btn-secondary"
                hx-post="{% url 'tasks-delete-completed-htmx' %}"
                hx-target="#tasks-container"
                hx-swap="innerHTML"
                hx-confirm="Are you sure you want to delete all completed tasks?">
            <i class="icon-trash-2"></i> Delete
        </button>
    </div>
{% endif %}
